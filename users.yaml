
# === Initiera standardkonfiguration om users.yaml saknas eller Ã¤r tom ===
if not os.path.exists(USERS_FILE):
    config = {
        "credentials": {"usernames": {}},
        "cookie": {"expiry_days": 30, "key": COOKIE_KEY, "name": "sql_optimizer_login"},
        "preauthorized": {"emails": []}
    }
    with open(USERS_FILE, "w") as f:
        yaml.dump(config, f)
else:
    with open(USERS_FILE) as f:
        config = yaml.safe_load(f)

    # Om nycklar saknas, skapa om config
    if "credentials" not in config or "usernames" not in config.get("credentials", {}):
        config = {
            "credentials": {"usernames": {}},
            "cookie": {"expiry_days": 30, "key": COOKIE_KEY, "name": "sql_optimizer_login"},
            "preauthorized": {"emails": []}
        }
        with open(USERS_FILE, "w") as f:
            yaml.dump(config, f)